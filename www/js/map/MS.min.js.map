{"version":3,"names":[],"mappings":"","sources":["MS.js"],"sourcesContent":["/* VAR TO LOCK CHANGE PAGE */\nvar lockChangePage = false;\n\n/* VAR TO LOOK EXIT PAGE, CLOSE BROWSER OR CLOSE TAB */\nvar lockClosePage = false;\n\nvar touchEvents = false;\n\n/* EVENTOS DE ESCUTA APENAS UMA VEZ */\nvar fakescroll;\nvar fakeresize;\n\nif(Event in window){\n\tfakescroll = new Event('fakescroll');\n\tfakeresize = new Event('fakeresize');\n}else if(document.createEvent){\n\n\tfakescroll = document.createEvent('Event');\n\tfakescroll.initEvent('fakescroll', true, false);\n\n\tfakeresize = document.createEvent('Event');\n\tfakeresize.initEvent('fakeresize', true, false);\n}\nwindow.MS = {\n\t/* ADD EVENTS */\n\tevts: {\n\t\tadd: function (evt, el, fn) {\n\t\t\tif(el !== null){\n\t\t\t\tif(window.addEventListener){\n\t\t\t\t\tel.addEventListener(evt, function(evt){\n\t\t\t\t\t\tfn(evt);\n\t\t\t\t\t}, true);\n\t\t\t\t}else{\n\t\t\t\t\tel.attachEvent(\"on\"+evt, function(){\n\t\t\t\t\t\tfn(evt);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\tscreensizes: function(){\n\n\t\tvar orient;\n\n\t\tif(window.screen.mozOrientation){\n\t\t\torient = window.screen.mozOrientation;\n\t\t}else if(window.screen.msOrientation){\n\t\t\torient = window.screen.msOrientation\n\t\t}else if(window.screen.orientation){\n\t\t\tif(window.screen.orientation.type){\n\t\t\t\torient = window.screen.orientation.type;\n\t\t\t}else{\n\t\t\t\torient = window.screen.orientation;\n\t\t\t}\n\t\t}else{\n\t\t\tif(window.screen.height > window.screen.width){\n\t\t\t\torient = 'portrait-primary';\n\t\t\t}else{\n\t\t\t\torient = 'landscape-primary';\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\t'viewWidth': window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth,\n\t\t\t'viewHeight': window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight,\n\t\t\t'pageWidth': document.body.clientWidth || document.body.offsetWidth,\n\t\t\t'pageHeight': document.body.clientHeight || document.body.offsetHeight,\n\t\t\t'resolutionWidth': window.screen.width,\n\t\t\t'resolutionHeight': window.screen.height,\n\t\t\t'orientation': orient,\n\t\t\t'colorDepth': window.screen.colorDepth,\n\t\t\t'pixelDepth': window.screen.pixelDepth\n\t\t}\n\n\t},\n\ttrigger: function (ev, el){\n\t\tif(document.createEvent){\n\t\t\tevento = document.createEvent('HTMLEvents');\n\t\t\tevento.initEvent(ev, true, true);\n\t\t\tel.dispatchEvent(evento);\n\t\t}else{\n\t\t\tevento = document.createEventObject();\n\t\t\tel.fireEvent('on'+ev, evento);\n\t\t}\n\t},\n\ttargt: function (e) {\n\t\te = e.target ? e : window.event;\n\t\treturn e.target || e.srcElement;\n\t},\n\tpushstate: {\n\t\tinit: function(configObj){\n\n\t\t\thistory.scrollRestoration = 'manual';\n\n\t\t\tvar xhrfn = function(){};\n\t\t\tvar lockChangePageFn = function(){};\n\t\t\tvar lockExitMessage = '';\n\n\t\t\tif(typeof(configObj.xhrfn) === 'function'){\n\t\t\t\txhrfn = configObj.xhrfn;\n\t\t\t}\n\n\t\t\tif(typeof(configObj.lockChangePageFn) === 'function'){\n\t\t\t\tlockChangePageFn = configObj.lockChangePageFn;\n\t\t\t}\n\n\t\t\tif(configObj.lockExitMessage){\n\t\t\t\tlockExitMessage = configObj.lockExitMessage;\n\t\t\t}\n\n\t\t\t/* POPSTATE EVENT */\n\t\t\tMS.evts.add('popstate', window, function(evts){\n\n\t\t\t\tif(lockChangePage === true){\n\t\t\t\t\tlockChangePageFn(evts.location.href);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tvar host = window.location.protocol+'//'+window.location.host;\n\t\t\t\tvar controler = evts.location.href.replace(host, '');\n\n\t\t\t\txhrfn(controler, function(){});\n\n\t\t\t});\n\n\t\t\t/* CLICK EVENTS */\n\t\t\tMS.evts.add('click', document, function(evts){\n\n\t\t\t\tvar elemt = evts.target;\n\n\t\t\t\tvar expJs = new RegExp('javascript:', 'i');\n\t\t\t\tvar expFTP = new RegExp('ftp:', 'i');\n\t\t\t\tvar expMail = new RegExp('mailto:', 'i');\n\t\t\t\tvar expWhatsapp = new RegExp('whatsapp:', 'i');\n\n\t\t\t\tvar domain = jsdominio;\n\n\t\t\t\tif(elemt.nodeName !== 'BUTTON' && elemt.parentElement !== null && elemt.parentElement.nodeName === 'BUTTON'){\n\t\t\t\t\telemt = elemt.parentElement;\n\t\t\t\t}\n\n\t\t\t\tif(elemt.nodeName === 'BUTTON' && elemt.getAttribute('data-push') && elemt.getAttribute('data-push') !== false){\n\n\t\t\t\t\tvar hrefDomain = elemt.getAttribute('data-push').replace('http://', '');\n\t\t\t\t\threfDomain = hrefDomain.replace('https://', '');\n\n\t\t\t\t\tvar re = new RegExp('^\\/', 'i'); \n\n\t\t\t\t\tif(re.test(hrefDomain) === true){\n\t\t\t\t\t\threfDomain = domain+hrefDomain;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar urlIn = new RegExp('^'+domain, 'i');\n\n\t\t\t\t\tif(urlIn.test(hrefDomain) === true){\n\t\t\t\t\t\tMS.pushstate.goXHR(elemt.getAttribute('data-push'), xhrfn, lockChangePageFn);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tvar a = document.createElement('a');\n\t\t\t\t\t\ta.href = elemt.getAttribute('data-push');\n\t\t\t\t\t\tMS.trigger('click', a);\n\t\t\t\t\t}\n\t\t\t\t}else{\n\n\t\t\t\t\tvar wl = true;\n\t\t\t\t\twhile(wl === true){\n\n\t\t\t\t\t\tif(elemt.parentNode !== null && elemt.nodeName !== 'A'){\n\t\t\t\t\t\t\telemt = elemt.parentNode;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\twl = false;\n\n\t\t\t\t\t\t\tif(elemt.href){\n\n\t\t\t\t\t\t\t\tvar hrefDomain = elemt.href.replace('http://', '');\n\t\t\t\t\t\t\t\threfDomain = hrefDomain.replace('https://', '');\n\n\t\t\t\t\t\t\t\tvar urlIn = new RegExp('^'+domain, 'i');\n\n\t\t\t\t\t\t\t\tif(urlIn.test(hrefDomain) === true && !elemt.getAttribute('data-push')){\n\n\t\t\t\t\t\t\t\t\t/* GOXHR*/\n\t\t\t\t\t\t\t\t\tif(expJs.test(elemt.href) === false || \n\t\t\t\t\t\t\t\t\t\texpFTP.test(elemt.href) === false || \n\t\t\t\t\t\t\t\t\t\texpMail.test(elemt.href) === false || \n\t\t\t\t\t\t\t\t\t\texpWhatsapp.test(elemt.href) === false || \n\t\t\t\t\t\t\t\t\t\t!elemt.getAttribute('data-href')){\n\n\t\t\t\t\t\t\t\t\t\tif(evts.stopPropagation){\n\t\t\t\t\t\t\t\t\t\t\tevts.stopPropagation();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif(evts.preventDefault){\n\t\t\t\t\t\t\t\t\t\t\tevts.preventDefault();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\txhrfn(elemt.href, xhrfn, lockChangePageFn);\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t/* beforeunload EVENT  */\n\t\t\twindow.addEventListener('beforeunload', window, function(evts){\n\t\t\t\tif(lockClosePage === true){\n\n\t\t\t\t\tevts.cancelBubble = true;\n\n\t\t\t\t\tevts.returnValue = lockExitMessage;\n\n\t\t\t\t\tif(evts.stopPropagation){\n\t\t\t\t\t\tevts.stopPropagation();\n\t\t\t\t\t}\n\n\t\t\t\t\tif(evts.preventDefault){\n\t\t\t\t\t\tevts.preventDefault();\n\t\t\t\t\t}\n\n\t\t\t\t\treturn lockExitMessage;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tgoXHR: function(controler, xhrfn, lockChangePageFn){\n\n\t\t\tif(lockChangePage === true && lockChangePageFn){\n\t\t\t\tlockChangePageFn(controler);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tvar host = window.location.protocol+'//'+window.location.host;\n\t\t\tvar ctrlpage = window.location.href.replace(host, '');\n\t\t\tctrlpage = ctrlpage.replace(/\\?.*$/, '');\n\t\t\tXHRPopStateScroll[ctrlpage] = window.scrollY || window.pageYOffset || document.documentElement.scrollTop;\n\n\t\t\txhrfn(controler, function(){\n\t\t\t\thistory.pushState({}, '', controler);\n\t\t\t});\n\n\t\t}\n\t},\n\tpositionAtTop: function(el){\n\t\tposicao = 0;\n\t\tif(el.offsetParent){\n\t\t\tdo{\n\t\t\t\tposicao += el.offsetTop;\n\t\t\t} while (el = el.offsetParent);\n\t\t}\n\t\treturn posicao;\n\t},\n\tdelay: function (fn, tm) {\n\t\twindow.setTimeout(function () {\n\t\t\tfn();\n\t\t}, tm);\n\t},\n\tajax: function (options) {\n\t\tvar XHR;\n\t\tvar strPost = new Array();\n\t\tvar r20 = /%20/g;\n\n\t\tif(window.XMLHttpRequest){\n\t\t\tXHR = new XMLHttpRequest();\n\t\t}else if(window.ActiveXObject){\n\t\t\tXHR = new ActiveXObject('Msxml2.XMLHTTP');\n\t\t\tif(!XHR){\n\t\t\t\tXHR = new ActiveXObject('Microsoft.XMLHTTP');\n\t\t\t}\n\t\t}else{\n\t\t\tconsole.warn('This Browser do not support XMLHttpRequest');\n\t\t\treturn false;\n\t\t}\n\n\t\tif(options.progress){\n\t\t\tXHR.upload.addEventListener('progress', options.progress, false);\n\t\t}\n\n\t\tif(options.error){\n\t\t\tXHR.addEventListener('error', options.error, false);\n\t\t\tXHR.addEventListener('abort', options.error, false);\n\t\t}\n\n\t\tXHR.open('POST', options.url, true);\n\n\t\t/* AS DATA */\n\t\tif(options.data){\n\n\t\t\tXHR.setRequestHeader(\"Content-type\",\"application/x-www-form-urlencoded;charset=UTF-8\");\n\n\t\t\tfor(x in options.data){\n\t\t\t\tstrPost.push(encodeURIComponent(x)+'='+encodeURIComponent(options.data[x]));\n\t\t\t}\n\n\t\t\tstPost = strPost.join('&').replace(r20, \"+\");\n\t\t\tXHR.send(stPost);\n\n\t\t/* AS FORM */\n\t\t}else if(options.formId){\n\n\t\t\tvar form = document.getElementById(options.formId);\n\t\t\tvar frm = new FormData();\n\n\t\t\tvar inputs = form.getElementsByTagName('input');\n\t\t\tvar tInputs = inputs.length;\n\n\t\t\tfor(x = 0; x < tInputs; x++){\n\t\t\t\tif(inputs[x].getAttribute('name') && !inputs[x].getAttribute('disabled')){\n\n\t\t\t\t\t/* INPUT FILE */\n\t\t\t\t\tif(inputs[x].type === 'file'){\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar tFiles = inputs[x].files.length;\n\n\t\t\t\t\t\tif(tFiles > 0){\n\t\t\t\t\t\t\tfor(z = 0; z < tFiles; z++){\n\t\t\t\t\t\t\t\tvar fle = inputs[x].files[z];\n\t\t\t\t\t\t\t\tfrm.append(inputs[x].getAttribute('name'), fle);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t/* RADIO AND CHECKBOX */\n\t\t\t\t\t}else if(inputs[x].type === 'radio' || inputs[x].type === 'checkbox'){\n\t\t\t\t\t\tif(inputs[x].checked === true){\n\t\t\t\t\t\t\tfrm.append(inputs[x].getAttribute('name'), inputs[x].value);\n\t\t\t\t\t\t}\n\t\t\t\t\t/* OTHERS INPUTS FIELDS */\n\t\t\t\t\t}else{\n\t\t\t\t\t\tfrm.append(inputs[x].getAttribute('name'), inputs[x].value);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar textareas = form.getElementsByTagName('textarea');\n\t\t\tvar tTextareas = textareas.length;\n\n\t\t\tfor(x = 0; x < tTextareas; x++){\n\t\t\t\tif(textareas[x].getAttribute('name') && !textareas[x].getAttribute('disabled')){\n\t\t\t\t\tfrm.append(textareas[x].getAttribute('name'), textareas[x].value);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar selects = form.getElementsByTagName('select');\n\t\t\tvar tSelects = selects.length;\n\n\t\t\tfor(x = 0; x < tSelects; x++){\n\t\t\t\tif(selects[x].getAttribute('name') && !selects[x].getAttribute('disabled')){\n\t\t\t\t\tfrm.append(selects[x].getAttribute('name'), selects[x].value);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tXHR.send(frm);\n\n\t\t}\n\t\tXHR.onreadystatechange = function(){\n\n\t\t\tif(XHR.readyState === 4 && (XHR.status === 200 || XHR.status === 304)){\n\t\t\t\tif(typeof(options.dataType) !== 'undefined'){\n\n\t\t\t\t\tif(options.dataType === 'JSON' || options.dataType === 'json'){\n\t\t\t\t\t\tjsonStr = XHR.responseText;\n\t\t\t\t\t\tif(JSON.parse(XHR.responseText)){\n\t\t\t\t\t\t\tjsonStr = eval(\"(\"+XHR.responseText+\")\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(typeof(options.done) === 'function'){\n\t\t\t\t\t\t\toptions.done(jsonStr);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}else{\n\t\t\t\t\tif (typeof(options.done) === 'function'){\n\t\t\t\t\t\toptions.done(XHR.responseText);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(XHR.readyState === 4 && XHR.status === 404){\n\t\t\t\tif(typeof(options.error) === 'function'){\n\t\t\t\t\toptions.error(XHR);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(XHR.readyState === 4 && XHR.status === 500){\n\t\t\t\tif(typeof(options.error) === 'function'){\n\t\t\t\t\toptions.error(XHR);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn XHR;\n\t}\n};"],"file":"../MS.min.js"}